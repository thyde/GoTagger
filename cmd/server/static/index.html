<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GoMark Bookmarks</title>
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <div class="container">
        <h1>GoMark Bookmarks</h1>
        <form id="addForm">
            <input type="url" id="url" placeholder="Bookmark URL" required>
            <input type="text" id="title" placeholder="Title">
            <input type="text" id="tags" placeholder="Tags (comma separated)">
            <label style="display:flex;align-items:center;gap:0.3em;"><input type="checkbox" id="favorite"> <span style="color:#fbbc04;">★ Favorite</span></label>
            <button type="submit">Add</button>
        </form>
        <input type="text" id="search" placeholder="Search bookmarks...">
        <div id="bookmarks"></div>
    </div>
    <script>
        async function fetchBookmarks(query = '') {
            const res = await fetch(`/api/bookmarks?search=${encodeURIComponent(query)}`);
            const bookmarks = await res.json();
            const container = document.getElementById('bookmarks');
            container.innerHTML = '';
            bookmarks.forEach(b => {
                container.innerHTML += `<div class="bookmark">
                    <a href="${b.url}" target="_blank">${b.title || b.url}</a>
                    ${b.favorite ? '<span class="favorite">★</span>' : ''}
                    <div class="tags">${(b.tags || []).join(', ')}</div>
                </div>`;
            });
        }
        document.getElementById('addForm').onsubmit = async e => {
            e.preventDefault();
            const data = {
                url: document.getElementById('url').value,
                title: document.getElementById('title').value,
                tags: document.getElementById('tags').value.split(',').map(t => t.trim()),
                favorite: document.getElementById('favorite').checked
            };
            await fetch('/api/bookmarks/add', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            e.target.reset();
            fetchBookmarks();
        };
        document.getElementById('search').oninput = e => {
            fetchBookmarks(e.target.value);
        };
        fetchBookmarks();
    </script>
</body>
</html>
